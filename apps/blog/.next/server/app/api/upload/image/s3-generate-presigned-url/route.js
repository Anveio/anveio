"use strict";(()=>{var e={};e.id=2561,e.ids=[2561],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6005:e=>{e.exports=require("node:crypto")},31645:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>k,originalPathname:()=>h,requestAsyncStorage:()=>m,routeModule:()=>x,serverHooks:()=>_,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>w});var s={};t.r(s),t.d(s,{POST:()=>POST}),t(44388);var n=t(15789),o=t(74902);let a=require("@aws-sdk/s3-presigned-post"),i=require("@aws-sdk/client-s3");var p=t(60620),u=t(73867),l=t(50532),d=t(70914),c=t(65773);let g=u.z.string({required_error:"AWS_BUCKET_NAME not provided"}).parse(process.env.AWS_BUCKET_NAME);async function POST(e){let r=(0,l.cookies)(),t=r.get("sessionToken")?.value;if(!t)return d.Z.json({status:400,error:"You must be logged in"});let s=t?await (0,c.tc)(t):void 0;if(!s)return d.Z.json({status:400,error:"Invalid session token"});let{filename:n,contentType:o}=await e.json();try{let e=new i.S3Client({region:process.env.AWS_REGION}),{url:r,fields:t}=await (0,a.createPresignedPost)(e,{Bucket:g,Key:(0,p.x0)(),Conditions:[["content-length-range",0,10485760],["starts-with","$Content-Type",o]],Fields:{acl:"private","Content-Type":o},Expires:600});return d.Z.json({url:r,fields:t})}catch(r){let{message:e}=r;return d.Z.json({error:e})}}let x=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/upload/image/s3-generate-presigned-url/route",pathname:"/api/upload/image/s3-generate-presigned-url",filename:"route",bundlePath:"app/api/upload/image/s3-generate-presigned-url/route"},resolvedPagePath:"/home/shovonh/workspaces/anveio/apps/blog/src/app/api/upload/image/s3-generate-presigned-url/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:v,serverHooks:_,headerHooks:k,staticGenerationBailout:w}=x,h="/api/upload/image/s3-generate-presigned-url/route"}};var r=require("../../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[7534,3369,3077,3867,962,1861,914,620,9654,5773],()=>__webpack_exec__(31645));module.exports=t})();